import{_ as ne}from"./BZSCje0E.js";import{p as oe,e as ae,u as le,b2 as se,H as re,bI as ie,m as S,cy as de,Z as T,J as $,ad as ce,f as i,o as l,w as a,b as o,a as r,j as L,q as Y,c as v,s,cX as b,K as k,F as f,r as _,t as w,P as y,aA as I,d as V,b0 as Z,D as Q,i as ue,cY as pe,l as me,cZ as ge,_ as ve}from"./GE5AgfcP.js";import{p as fe}from"./VAKVee9w.js";import{_ as ye}from"./BDw0eM9J.js";import{V as z}from"./CMZ1Vk9O.js";import{V as H}from"./D1ozmfGb.js";import{V as be}from"./BJm6j7Cg.js";import{V as _e}from"./C5HPuv8F.js";import{V as ke}from"./D8tUBk7h.js";import"./BhnQ7N1B.js";import"./CM-orCka.js";const K=oe("/logo/devunity-letter.png"),he={class:"drawer-header pa-4"},xe={class:"text-caption"},we={class:"text-caption"},De={class:"drawer-header pa-4"},Se={class:"text-caption"},Ve={class:"text-caption"},Ae={class:"d-flex align-center"},Ce={class:"text-h5 font-weight-bold"},Ne={class:"content-wrapper"},Ue=ae({__name:"dashboard",setup(Le){const g=le(),P=se(),W=re(),B=ie(),A=S([]),C=S(""),D=de(),h=S(!1),R=S(!D.smAndDown.value),m=S("Dashboard");T(()=>B.path,()=>{D.smAndDown.value&&(h.value=!1),q()}),T(()=>D.smAndDown.value,e=>{e||(R.value=!0)});const q=()=>{const e=B.path;if(e==="/dashboard")m.value="Dashboard";else if(e.includes("/snippets"))m.value="Snippets";else if(e.includes("/sql-generator"))m.value="Database Designer";else if(e.includes("/studio"))m.value="Studio";else if(e.includes("/responsive"))m.value="Responsive";else if(e.includes("/accessibility"))m.value="Accessibility";else if(e.includes("/seo-audit"))m.value="SEO Audit";else if(e.includes("/settings"))m.value="Settings";else if(e.includes("/newsletter-admin"))m.value="Newsletter";else{const n=e.split("/").pop()||"Dashboard";m.value=n.charAt(0).toUpperCase()+n.slice(1)}},N=$(()=>[...g.personalSnippets].sort((e,n)=>{const p=F(e);return F(n)-p}).slice(0,5)),U=$(()=>[...g.sqlSchemas].slice(0,5)),G=e=>{if(e&&e.schema_data)try{const n=typeof e.schema_data=="string"?JSON.parse(e.schema_data):e.schema_data;return n.tables?n.tables.length:0}catch(n){return console.error("Error parsing schema data:",n),0}return 0},F=e=>{if(e){const n=e.date||e.snippet_date;if(n){const p=new Date(n);if(!isNaN(p.getTime()))return p.getTime()}}return 0},M=e=>{if(e){const n=e.date||e.snippet_date;if(n)return ee(n)}return"Date unknown"},ee=e=>{if(!e)return"Date unknown";try{const n=new Date(e);if(isNaN(n.getTime()))return"Invalid date";const x=Math.abs(new Date().getTime()-n.getTime()),t=Math.ceil(x/(1e3*60*60*24));return t===1?"Yesterday":t<7?`${t} days ago`:n.toLocaleDateString("en-GB",{day:"2-digit",month:"2-digit",year:"numeric"})}catch(n){return console.error("Error formatting date:",n),"Date error"}},O=e=>{switch(e==null?void 0:e.toLowerCase()){case"react":return"mdi-react";case"vue.js 3":case"vue":return"mdi-vuejs";case"angular":return"mdi-angular";case"nest.js":return"mdi-nodejs";case"nuxt 3":case"nuxt":return"mdi-nuxt";default:return"mdi-code-tags"}},te=()=>{const e=B.path;return e==="/dashboard"?"mdi-view-dashboard-outline":e.includes("/snippets")?"mdi-code-tags":e.includes("/sql-generator")?"mdi-database-cog":e.includes("/studio")?"mdi-palette":e.includes("/responsive")?"mdi-responsive":e.includes("/accessibility")?"mdi-access-point":e.includes("/seo-audit")?"mdi-magnify":e.includes("/robots")?"mdi-robot":e.includes("/settings")?"mdi-cog-outline":e.includes("/newsletter-admin")?"mdi-email-outline":"mdi-application"},c=()=>{D.smAndDown.value&&(h.value=!1)},J=async()=>{try{await g.logout(),c(),W.push("/login")}catch(e){console.error("Error during logout:",e)}};ce(()=>{var e;g.loadSnippets(),g.loadSQLSchemas(),q(),console.log("[DEBUG] Marketing activé dans layout dashboard:",P.preferences.marketing),console.log("[DEBUG] Analytics activé dans layout dashboard:",P.preferences.analytics),console.log("[DEBUG] Préférences cookies complètes:",P.preferences),console.log("[DEBUG] Statut premium de l'utilisateur:",(e=g.user)==null?void 0:e.isPremium)}),T(()=>{var e;return(e=g.user)==null?void 0:e.isPremium},e=>{console.log("[DEBUG] Changement du statut premium détecté:",e)},{immediate:!0});function E(e,n,p,x){var t;return(t=g.user)!=null&&t.isPremium?{title:e,link:n,icon:p}:{title:`${e} (Premium)`,link:"#",icon:p,component:{component:ge(fe),props:{type:"list-item",title:e,icon:p,featureKey:x}}}}const X=$(()=>[{title:"Frontend",prependIcon:"mdi-web",link:!0,children:[{title:"Snippets",link:"/snippets",icon:"mdi-code-tags"},{title:"Studio",link:"/studio",icon:"mdi-palette"}]},{title:"Backend",prependIcon:"mdi-database-outline",link:!0,children:[E("Database Designer","/sql-generator","mdi-database","databaseDesigner")]},{title:"UI/UX",prependIcon:"mdi-palette",link:!0,children:[{title:"Responsive",link:"/responsive",icon:"mdi-responsive"},{title:"Accessibility",link:"/accessibility",icon:"mdi-access-point"}]},{title:"SEO",prependIcon:"mdi-rocket-launch-outline",link:!0,children:[E("SEO Audit","/seo-audit","mdi-magnify","seoAudit"),E("Robots & Schema","/robots","mdi-robot","robots")]}]);return(e,n)=>{const p=ne,x=pe;return l(),i(me,null,{default:a(()=>[o(ye),o(z,{modelValue:h.value,"onUpdate:modelValue":n[2]||(n[2]=t=>h.value=t),temporary:"",class:"d-sm-none",app:"",clipped:""},{default:a(()=>[r("div",he,[n[7]||(n[7]=r("div",{class:"d-flex align-center mb-4"},[r("div",{class:"logo-container mr-3"},[r("img",{src:K,alt:"DevUnity",class:"logo-devunity"})]),r("div",null,[r("div",{class:"text-h6 font-weight-bold"},"DevUnity"),r("div",{class:"text-caption text-medium-emphasis"},"v1.0.0")])],-1)),o(H,{modelValue:C.value,"onUpdate:modelValue":n[0]||(n[0]=t=>C.value=t),density:"compact",variant:"outlined",placeholder:"Search...","prepend-inner-icon":"mdi-magnify","hide-details":"",rounded:"",class:"mb-2","bg-color":"surface"},null,8,["modelValue"])]),o(L),o(Y,{density:"compact",opened:A.value,"onUpdate:opened":n[1]||(n[1]=t=>A.value=t),nav:"",class:"px-2"},{default:a(()=>[o(s,{to:"/dashboard","prepend-icon":"mdi-view-dashboard-outline",title:"Dashboard",rounded:"lg",class:"mb-1",color:"primary",nuxt:"",onClick:c}),o(b,{value:"Recent Projects",class:"mb-1","prepend-icon":"mdi-history"},{activator:a(({props:t})=>[o(s,y(t,{title:"Recent Projects",rounded:"lg",color:"primary"}),null,16)]),default:a(()=>[(l(!0),v(f,null,_(N.value,(t,u)=>(l(),i(s,{key:u,to:`/snippets?id=${t.id}`,title:t.title,"prepend-icon":O(t.framework),class:"ml-4",rounded:"lg",color:"primary",nuxt:"",onClick:c},{subtitle:a(()=>[r("span",xe,w(M(t)),1)]),_:2},1032,["to","title","prepend-icon"]))),128)),N.value.length===0?(l(),i(s,{key:0,class:"ml-4",title:"No recent projects",disabled:""})):k("",!0)]),_:1}),o(b,{value:"Recent SQL schemas",class:"mb-1","prepend-icon":"mdi-database-outline"},{activator:a(({props:t})=>[o(s,y(t,{title:"Recent SQL schemas",rounded:"lg",color:"primary"}),null,16)]),default:a(()=>[(l(!0),v(f,null,_(U.value,(t,u)=>(l(),i(s,{key:u,to:`/sql-generator?id=${t.id}`,title:t.database_name,"prepend-icon":"mdi-database",class:"ml-4",rounded:"lg",color:"primary",nuxt:"",onClick:c},{subtitle:a(()=>[r("span",we,w(G(t))+" tables",1)]),_:2},1032,["to","title"]))),128)),U.value.length===0?(l(),i(s,{key:0,class:"ml-4",title:"No recent SQL schemas",disabled:""})):k("",!0)]),_:1}),o(I,{class:"mt-2 text-uppercase font-weight-bold text-caption"},{default:a(()=>n[8]||(n[8]=[V("Applications")])),_:1}),(l(!0),v(f,null,_(X.value,(t,u)=>(l(),i(b,{key:u,value:t.title,class:"mb-1","prepend-icon":t.prependIcon},{activator:a(({props:d})=>[o(s,y({ref_for:!0},d,{title:t.title,rounded:"lg",color:"primary"}),null,16,["title"])]),default:a(()=>[(l(!0),v(f,null,_(t.children,(d,j)=>(l(),v(f,{key:j},[d.component?(l(),i(Z(d.component.component),y({key:0,ref_for:!0},d.component.props,{class:"ml-4 my-1 premium-menu-item"}),null,16)):(l(),i(s,{key:1,to:d.link,title:d.title,"prepend-icon":d.icon||"mdi-circle-small",class:"ml-4",rounded:"lg",color:"primary",nuxt:"",onClick:c},null,8,["to","title","prepend-icon"]))],64))),128))]),_:2},1032,["value","prepend-icon"]))),128)),o(L,{class:"my-3"}),o(I,{class:"text-uppercase font-weight-bold text-caption"},{default:a(()=>n[9]||(n[9]=[V("System")])),_:1}),o(p,null,{default:a(()=>{var t;return[(t=Q(g).user)!=null&&t.isAdmin?(l(),i(b,{key:0,value:"Administration",class:"mb-1","prepend-icon":"mdi-shield-account"},{activator:a(({props:u})=>[o(s,y(u,{title:"Administration",rounded:"lg",color:"primary"}),null,16)]),default:a(()=>[o(s,{to:"/admin/newsletter-admin","prepend-icon":"mdi-email-outline",title:"Newsletter",rounded:"lg",class:"ml-4",color:"primary",nuxt:"",onClick:c}),o(s,{to:"/admin/analytics","prepend-icon":"mdi-chart-box",title:"Analytics",rounded:"lg",class:"ml-4",color:"primary",nuxt:"",onClick:c})]),_:1})):k("",!0)]}),_:1}),o(s,{to:"/settings","prepend-icon":"mdi-cog-outline",title:"Settings",rounded:"lg",class:"mb-1",color:"primary",nuxt:"",onClick:c}),o(s,{onClick:J,"prepend-icon":"mdi-logout",title:"Logout",rounded:"lg",color:"error"})]),_:1},8,["opened"])]),_:1},8,["modelValue"]),o(z,{modelValue:R.value,"onUpdate:modelValue":n[5]||(n[5]=t=>R.value=t),permanent:"",class:"d-none d-sm-block",app:"",clipped:""},{default:a(()=>[r("div",De,[n[10]||(n[10]=r("div",{class:"d-flex align-center mb-4"},[r("div",{class:"logo-container mr-3"},[r("img",{src:K,alt:"DevUnity",class:"logo-devunity"})]),r("div",null,[r("div",{class:"text-h6 font-weight-bold"},"DevUnity"),r("div",{class:"text-caption text-medium-emphasis"},"v1.0.0")])],-1)),o(H,{modelValue:C.value,"onUpdate:modelValue":n[3]||(n[3]=t=>C.value=t),density:"compact",variant:"outlined",placeholder:"Search...","prepend-inner-icon":"mdi-magnify","hide-details":"",rounded:"",class:"mb-2","bg-color":"surface"},null,8,["modelValue"])]),o(L),o(Y,{density:"compact",opened:A.value,"onUpdate:opened":n[4]||(n[4]=t=>A.value=t),nav:"",class:"px-2"},{default:a(()=>[o(s,{to:"/dashboard","prepend-icon":"mdi-view-dashboard-outline",title:"Dashboard",rounded:"lg",class:"mb-1",color:"primary",nuxt:"",onClick:c}),o(b,{value:"Recent Projects",class:"mb-1","prepend-icon":"mdi-history"},{activator:a(({props:t})=>[o(s,y(t,{title:"Recent Projects",rounded:"lg",color:"primary"}),null,16)]),default:a(()=>[(l(!0),v(f,null,_(N.value,(t,u)=>(l(),i(s,{key:u,to:`/snippets?id=${t.id}`,title:t.title,"prepend-icon":O(t.framework),class:"ml-4",rounded:"lg",color:"primary",nuxt:"",onClick:c},{subtitle:a(()=>[r("span",Se,w(M(t)),1)]),_:2},1032,["to","title","prepend-icon"]))),128)),N.value.length===0?(l(),i(s,{key:0,class:"ml-4",title:"No recent projects",disabled:""})):k("",!0)]),_:1}),o(b,{value:"Recent SQL schemas",class:"mb-1","prepend-icon":"mdi-database-outline"},{activator:a(({props:t})=>[o(s,y(t,{title:"Recent SQL schemas",rounded:"lg",color:"primary"}),null,16)]),default:a(()=>[(l(!0),v(f,null,_(U.value,(t,u)=>(l(),i(s,{key:u,to:`/sql-generator?id=${t.id}`,title:t.database_name,"prepend-icon":"mdi-database",class:"ml-4",rounded:"lg",color:"primary",nuxt:"",onClick:c},{subtitle:a(()=>[r("span",Ve,w(G(t))+" tables",1)]),_:2},1032,["to","title"]))),128)),U.value.length===0?(l(),i(s,{key:0,class:"ml-4",title:"No recent SQL schemas",disabled:""})):k("",!0)]),_:1}),o(I,{class:"mt-2 text-uppercase font-weight-bold text-caption"},{default:a(()=>n[11]||(n[11]=[V("Applications")])),_:1}),(l(!0),v(f,null,_(X.value,(t,u)=>(l(),i(b,{key:u,value:t.title,class:"mb-1","prepend-icon":t.prependIcon},{activator:a(({props:d})=>[o(s,y({ref_for:!0},d,{title:t.title,rounded:"lg",color:"primary"}),null,16,["title"])]),default:a(()=>[(l(!0),v(f,null,_(t.children,(d,j)=>(l(),v(f,{key:j},[d.component?(l(),i(Z(d.component.component),y({key:0,ref_for:!0},d.component.props,{class:"ml-4 my-1 premium-menu-item"}),null,16)):(l(),i(s,{key:1,to:d.link,title:d.title,"prepend-icon":d.icon||"mdi-circle-small",class:"ml-4",rounded:"lg",color:"primary",nuxt:"",onClick:c},null,8,["to","title","prepend-icon"]))],64))),128))]),_:2},1032,["value","prepend-icon"]))),128)),o(L,{class:"my-3"}),o(I,{class:"text-uppercase font-weight-bold text-caption"},{default:a(()=>n[12]||(n[12]=[V("System")])),_:1}),o(p,null,{default:a(()=>{var t;return[(t=Q(g).user)!=null&&t.isAdmin?(l(),i(b,{key:0,value:"Administration",class:"mb-1","prepend-icon":"mdi-shield-account"},{activator:a(({props:u})=>[o(s,y(u,{title:"Administration",rounded:"lg",color:"primary"}),null,16)]),default:a(()=>[o(s,{to:"/admin/newsletter-admin","prepend-icon":"mdi-email-outline",title:"Newsletter",rounded:"lg",class:"ml-4",color:"primary",nuxt:"",onClick:c}),o(s,{to:"/admin/analytics","prepend-icon":"mdi-chart-box",title:"Analytics",rounded:"lg",class:"ml-4",color:"primary",nuxt:"",onClick:c})]),_:1})):k("",!0)]}),_:1}),o(s,{to:"/settings","prepend-icon":"mdi-cog-outline",title:"Settings",rounded:"lg",class:"mb-1",color:"primary",nuxt:"",onClick:c}),o(s,{onClick:J,"prepend-icon":"mdi-logout",title:"Logout",rounded:"lg",color:"error"})]),_:1},8,["opened"])]),_:1},8,["modelValue"]),o(be,{class:"border-b page-header px-4",color:"primary",flat:"","scroll-behavior":"elevate",elevation:0},{default:a(()=>[Q(D).smAndDown.value?(l(),i(_e,{key:0,onClick:n[6]||(n[6]=t=>h.value=!h.value),color:"white"})):k("",!0),r("div",Ae,[o(ue,{size:"large",class:"mr-3"},{default:a(()=>[V(w(te()),1)]),_:1}),r("div",Ce,w(m.value),1)])]),_:1}),o(ke,{class:"pa-0"},{default:a(()=>[r("div",Ne,[o(x)])]),_:1})]),_:1})}}}),Fe=ve(Ue,[["__scopeId","data-v-36af71aa"]]);export{Fe as default};
