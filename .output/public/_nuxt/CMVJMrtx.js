import{_ as J}from"./CeOpyYWr.js";import{p as W,u as X,Z as Y,d as $,g as K,h as r,aU as k,O as j,c as ee,aV as te,f as ae,_ as ne}from"./CTpYCmOx.js";import{p as se}from"./BpFS7bpo.js";import{_ as oe}from"./BoMJ2DC6.js";import{h as re,ad as ie,W as le,d as D,w as N,c as U,x as de,a5 as c,a6 as o,a7 as s,m as n,ac as d,a9 as y,ab as w,F as b,aa as S,$ as x,n as h,a8 as B,Z as ce,u as ue,H as me}from"./CoKilWGJ.js";import{a3 as pe}from"./BOmTdu30.js";import{V as fe}from"./D2sKo5Om.js";import{V as ge}from"./B2zV2hO7.js";import{V as ve}from"./BjfENyHQ.js";import{V as ye}from"./0pmjIYKj.js";import"./BJLcRbSt.js";import"./BFhaMN7O.js";const be=W("/logo/devunity-letter.png"),he={class:"drawer-header pa-4"},_e={class:"text-caption"},ke={class:"text-caption"},De={class:"d-flex align-center"},we={class:"text-h5 font-weight-bold"},Se=re({__name:"dashboard",setup(xe){const u=X(),V=Y(),G=ie(),A=le(),L=D([]),I=D(""),_=pe(),g=D(!_.smAndDown.value),i=D("Dashboard");N(()=>A.path,()=>{_.smAndDown.value&&(g.value=!1),P()}),N(()=>_.smAndDown.value,e=>{e||(g.value=!0)});const P=()=>{const e=A.path;if(e==="/dashboard")i.value="Dashboard";else if(e.includes("/snippets"))i.value="Snippets";else if(e.includes("/sql-generator"))i.value="Database Designer";else if(e.includes("/studio"))i.value="Studio";else if(e.includes("/responsive"))i.value="Responsive";else if(e.includes("/accessibility"))i.value="Accessibility";else if(e.includes("/seo-audit"))i.value="SEO Audit";else if(e.includes("/settings"))i.value="Settings";else if(e.includes("/newsletter-admin"))i.value="Newsletter";else{const t=e.split("/").pop()||"Dashboard";i.value=t.charAt(0).toUpperCase()+t.slice(1)}},E=U(()=>[...u.personalSnippets].sort((e,t)=>{const l=T(e);return T(t)-l}).slice(0,5)),R=U(()=>[...u.sqlSchemas].slice(0,5)),F=e=>{if(e&&e.schema_data)try{const t=typeof e.schema_data=="string"?JSON.parse(e.schema_data):e.schema_data;return t.tables?t.tables.length:0}catch(t){return console.error("Error parsing schema data:",t),0}return 0},T=e=>{if(e){const t=e.date||e.snippet_date;if(t){const l=new Date(t);if(!isNaN(l.getTime()))return l.getTime()}}return 0},M=e=>{if(e){const t=e.date||e.snippet_date;if(t)return q(t)}return"Date unknown"},q=e=>{if(!e)return"Date unknown";try{const t=new Date(e);if(isNaN(t.getTime()))return"Invalid date";const f=Math.abs(new Date().getTime()-t.getTime()),a=Math.ceil(f/(1e3*60*60*24));return a===1?"Yesterday":a<7?`${a} days ago`:t.toLocaleDateString("en-GB",{day:"2-digit",month:"2-digit",year:"numeric"})}catch(t){return console.error("Error formatting date:",t),"Date error"}},O=e=>{switch(e?.toLowerCase()){case"react":return"mdi-react";case"vue.js 3":case"vue":return"mdi-vuejs";case"angular":return"mdi-angular";case"nest.js":return"mdi-nodejs";case"nuxt 3":case"nuxt":return"mdi-nuxt";default:return"mdi-code-tags"}},Q=()=>{const e=A.path;return e==="/dashboard"?"mdi-view-dashboard-outline":e.includes("/snippets")?"mdi-code-tags":e.includes("/sql-generator")?"mdi-database-cog":e.includes("/studio")?"mdi-palette":e.includes("/responsive")?"mdi-responsive":e.includes("/accessibility")?"mdi-access-point":e.includes("/seo-audit")?"mdi-magnify":e.includes("/robots")?"mdi-robot":e.includes("/settings")?"mdi-cog-outline":e.includes("/newsletter-admin")?"mdi-email-outline":"mdi-application"},m=()=>{_.smAndDown.value&&(g.value=!1)},Z=async()=>{try{await u.logout(),m(),G.push("/login")}catch(e){console.error("Error during logout:",e)}};de(()=>{u.loadSnippets(),u.loadSQLSchemas(),P(),console.log("[DEBUG] Marketing activé dans layout dashboard:",V.preferences.marketing),console.log("[DEBUG] Analytics activé dans layout dashboard:",V.preferences.analytics),console.log("[DEBUG] Préférences cookies complètes:",V.preferences),console.log("[DEBUG] Statut premium de l'utilisateur:",u.user?.isPremium)}),N(()=>u.user?.isPremium,e=>{console.log("[DEBUG] Changement du statut premium détecté:",e)},{immediate:!0});function C(e,t,l,f){return u.user?.isPremium?{title:e,link:t,icon:l}:{title:`${e} (Premium)`,link:"#",icon:l,component:{component:me(se),props:{type:"list-item",title:e,icon:l,featureKey:f}}}}const z=U(()=>[{title:"Frontend",prependIcon:"mdi-web",link:!0,children:[{title:"Snippets",link:"/snippets",icon:"mdi-code-tags"},{title:"Studio",link:"/studio",icon:"mdi-palette"}]},{title:"Backend",prependIcon:"mdi-database-outline",link:!0,children:[C("Database Designer","/sql-generator","mdi-database","databaseDesigner")]},{title:"UI/UX",prependIcon:"mdi-palette",link:!0,children:[{title:"Responsive",link:"/responsive",icon:"mdi-responsive"},{title:"Accessibility",link:"/accessibility",icon:"mdi-access-point"}]},{title:"SEO",prependIcon:"mdi-rocket-launch-outline",link:!0,children:[C("SEO Audit","/seo-audit","mdi-magnify","seoAudit"),C("Robots & Schema","/robots","mdi-robot","robots")]}]);return(e,t)=>{const l=J,f=te;return o(),c(ae,null,{default:s(()=>[n(oe),n(fe,{modelValue:g.value,"onUpdate:modelValue":t[2]||(t[2]=a=>g.value=a),temporary:e.$vuetify.display.smAndDown,permanent:!e.$vuetify.display.smAndDown,app:"",clipped:"",class:"elevation-2"},{default:s(()=>[d("div",he,[t[3]||(t[3]=d("div",{class:"d-flex align-center mb-4"},[d("div",{class:"logo-container mr-3"},[d("img",{src:be,alt:"DevUnity",class:"logo-devunity"})]),d("div",null,[d("div",{class:"text-h6 font-weight-bold"},"DevUnity"),d("div",{class:"text-caption text-medium-emphasis"},"v1.0.0")])],-1)),n(ge,{modelValue:I.value,"onUpdate:modelValue":t[0]||(t[0]=a=>I.value=a),density:"compact",variant:"outlined",placeholder:"Search...","prepend-inner-icon":"mdi-magnify","hide-details":"",rounded:"",class:"mb-2","bg-color":"surface"},null,8,["modelValue"])]),n($),n(K,{density:"compact",opened:L.value,"onUpdate:opened":t[1]||(t[1]=a=>L.value=a),nav:"",class:"px-2"},{default:s(()=>[n(r,{to:"/dashboard","prepend-icon":"mdi-view-dashboard-outline",title:"Dashboard",rounded:"lg",class:"mb-1",color:"primary",nuxt:"",onClick:m}),n(k,{value:"Recent Projects",class:"mb-1","prepend-icon":"mdi-history"},{activator:s(({props:a})=>[n(r,h(a,{title:"Recent Projects",rounded:"lg",color:"primary"}),null,16)]),default:s(()=>[(o(!0),y(b,null,S(E.value,(a,v)=>(o(),c(r,{key:v,to:`/snippets?id=${a.id}`,title:a.title,"prepend-icon":O(a.framework),class:"ml-4",rounded:"lg",color:"primary",nuxt:"",onClick:m},{subtitle:s(()=>[d("span",_e,x(M(a)),1)]),_:2},1032,["to","title","prepend-icon"]))),128)),E.value.length===0?(o(),c(r,{key:0,class:"ml-4",title:"No recent projects",disabled:""})):w("",!0)]),_:1}),n(k,{value:"Recent SQL schemas",class:"mb-1","prepend-icon":"mdi-database-outline"},{activator:s(({props:a})=>[n(r,h(a,{title:"Recent SQL schemas",rounded:"lg",color:"primary"}),null,16)]),default:s(()=>[(o(!0),y(b,null,S(R.value,(a,v)=>(o(),c(r,{key:v,to:`/sql-generator?id=${a.id}`,title:a.database_name,"prepend-icon":"mdi-database",class:"ml-4",rounded:"lg",color:"primary",nuxt:"",onClick:m},{subtitle:s(()=>[d("span",ke,x(F(a))+" tables",1)]),_:2},1032,["to","title"]))),128)),R.value.length===0?(o(),c(r,{key:0,class:"ml-4",title:"No recent SQL schemas",disabled:""})):w("",!0)]),_:1}),n(j,{class:"mt-2 text-uppercase font-weight-bold text-caption"},{default:s(()=>t[4]||(t[4]=[B("Applications")])),_:1}),(o(!0),y(b,null,S(z.value,(a,v)=>(o(),c(k,{key:v,value:a.title,class:"mb-1","prepend-icon":a.prependIcon},{activator:s(({props:p})=>[n(r,h({ref_for:!0},p,{title:a.title,rounded:"lg",color:"primary"}),null,16,["title"])]),default:s(()=>[(o(!0),y(b,null,S(a.children,(p,H)=>(o(),y(b,{key:H},[p.component?(o(),c(ce(p.component.component),h({key:0,ref_for:!0},p.component.props,{class:"ml-4 my-1 premium-menu-item"}),null,16)):(o(),c(r,{key:1,to:p.link,title:p.title,"prepend-icon":p.icon||"mdi-circle-small",class:"ml-4",rounded:"lg",color:"primary",nuxt:"",onClick:m},null,8,["to","title","prepend-icon"]))],64))),128))]),_:2},1032,["value","prepend-icon"]))),128)),n($,{class:"my-3"}),n(j,{class:"text-uppercase font-weight-bold text-caption"},{default:s(()=>t[5]||(t[5]=[B("System")])),_:1}),n(l,null,{default:s(()=>[ue(u).user?.isAdmin?(o(),c(k,{key:0,value:"Administration",class:"mb-1","prepend-icon":"mdi-shield-account"},{activator:s(({props:a})=>[n(r,h(a,{title:"Administration",rounded:"lg",color:"primary"}),null,16)]),default:s(()=>[n(r,{to:"/admin/newsletter-admin","prepend-icon":"mdi-email-outline",title:"Newsletter",rounded:"lg",class:"ml-4",color:"primary",nuxt:"",onClick:m}),n(r,{to:"/admin/analytics","prepend-icon":"mdi-chart-box",title:"Analytics",rounded:"lg",class:"ml-4",color:"primary",nuxt:"",onClick:m})]),_:1})):w("",!0)]),_:1}),n(r,{to:"/settings","prepend-icon":"mdi-cog-outline",title:"Settings",rounded:"lg",class:"mb-1",color:"primary",nuxt:"",onClick:m}),n(r,{onClick:Z,"prepend-icon":"mdi-logout",title:"Logout",rounded:"lg",color:"error"})]),_:1},8,["opened"])]),_:1},8,["modelValue","temporary","permanent"]),n(ve,null,{default:s(()=>[e.$vuetify.display.smAndDown?w("",!0):(o(),c(ye,{key:0,color:"primary",flat:"",class:"border-b page-header px-4","scroll-behavior":"elevate",elevation:0},{default:s(()=>[d("div",De,[n(ee,{size:"large",class:"mr-3"},{default:s(()=>[B(x(Q()),1)]),_:1}),d("div",we,x(i.value),1)])]),_:1})),n(f)]),_:1})]),_:1})}}}),$e=ne(Se,[["__scopeId","data-v-b5389df5"]]);export{$e as default};
