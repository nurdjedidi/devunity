import{e as O,u as W,m,ae as q,c as E,b as i,w as l,be as J,H as X,o as V,a as e,F as $,r as Y,n as Q,i as L,d as P,t as v,h as Z,j as T,I as ee,K as te,g as R,M as ae,_ as re}from"./D7DrY462.js";import{_ as I}from"./7NxHXX4m.js";import{u as ne}from"./ZBz0wOaK.js";import{V as oe}from"./McPLFUC7.js";import{V as N,a as j}from"./BqPcj89n.js";import{V as se}from"./CwvLLUxT.js";import{V as ie}from"./BRQFzjjH.js";import{V as le}from"./BZgkbz8H.js";import"./CPzxuhGu.js";import"./D0R1KJJ6.js";var B="acacia",ce=function(a){return a===3?"v3":a},z="https://js.stripe.com",de="".concat(z,"/").concat(B,"/stripe.js"),ue=/^https:\/\/js\.stripe\.com\/v3\/?(\?.*)?$/,me=/^https:\/\/js\.stripe\.com\/(v3|[a-z]+)\/stripe\.js(\?.*)?$/;var ve=function(a){return ue.test(a)||me.test(a)},pe=function(){for(var a=document.querySelectorAll('script[src^="'.concat(z,'"]')),r=0;r<a.length;r++){var n=a[r];if(ve(n.src))return n}return null},F=function(a){var r="",n=document.createElement("script");n.src="".concat(de).concat(r);var s=document.head||document.body;if(!s)throw new Error("Expected document.body not to be null. Stripe.js requires a <body> element.");return s.appendChild(n),n},fe=function(a,r){!a||!a._registerWrapper||a._registerWrapper({name:"stripe-js",version:"6.1.0",startTime:r})},S=null,C=null,k=null,ge=function(a){return function(r){a(new Error("Failed to load Stripe.js",{cause:r}))}},he=function(a,r){return function(){window.Stripe?a(window.Stripe):r(new Error("Stripe.js not available"))}},ye=function(a){return S!==null?S:(S=new Promise(function(r,n){if(typeof window>"u"||typeof document>"u"){r(null);return}if(window.Stripe){r(window.Stripe);return}try{var s=pe();if(!(s&&a)){if(!s)s=F(a);else if(s&&k!==null&&C!==null){var u;s.removeEventListener("load",k),s.removeEventListener("error",C),(u=s.parentNode)===null||u===void 0||u.removeChild(s),s=F(a)}}k=he(r,n),C=ge(n),s.addEventListener("load",k),s.addEventListener("error",C)}catch(p){n(p);return}}),S.catch(function(r){return S=null,Promise.reject(r)}))},be=function(a,r,n){if(a===null)return null;var s=r[0],u=s.match(/^pk_test/),p=ce(a.version),h=B;u&&p!==h&&console.warn("Stripe.js@".concat(p," was loaded on the page, but @stripe/stripe-js@").concat("6.1.0"," expected Stripe.js@").concat(h,". This may result in unexpected behavior. For more information, see https://docs.stripe.com/sdks/stripejs-versioning"));var x=a.apply(void 0,r);return fe(x,n),x},_,G=!1,H=function(){return _||(_=ye(null).catch(function(a){return _=null,Promise.reject(a)}),_)};Promise.resolve().then(function(){return H()}).catch(function(d){G||console.warn(d)});var xe=function(){for(var a=arguments.length,r=new Array(a),n=0;n<a;n++)r[n]=arguments[n];G=!0;var s=Date.now();return H().then(function(u){return be(u,r,s)})},we={};const Se={class:"auth-screen"},_e={class:"left-content text-center"},Ee={class:"features-list"},Ve={class:"text-left"},Pe={class:"text-body-1 font-weight-medium text-white mb-1"},je={class:"text-body-2 text-white-darken-2"},Ce={class:"mb-6 px-3 py-4 bg-surface-variant rounded-lg"},ke={class:"d-flex justify-space-between align-center mb-3"},Le={class:"text-h6 font-weight-bold"},Ue={class:"d-flex justify-space-between align-center mb-1"},Ae={class:"text-body-2"},De={class:"d-flex justify-space-between align-center"},Te={class:"text-body-2 text-medium-emphasis"},Re={class:"text-body-2"},Ie={class:"d-flex justify-space-between align-center"},Ne={class:"text-h6 font-weight-bold"},Fe={class:"credit-card-container mb-6"},Be={class:"credit-card-wrapper"},ze={key:0,class:"text-error mb-4 text-body-2"},Ge={class:"d-flex align-center justify-center mt-5"},He=O({__name:"checkout",setup(d){ne({title:"Payment - DevUnity",meta:[{name:"author",content:"Nûr"},{name:"description",content:"Pay to access premium features of DevUnity"},{name:"robots",content:"index,follow"},{name:"viewport",content:"width=device-width, initial-scale=1.0"},{name:"og:title",content:"Payment - DevUnity"},{name:"og:description",content:"Pay to access premium features of DevUnity"},{name:"og:image",content:"/logo/devunity-title.png"}],link:[{rel:"canonical",href:"https://devunity.com/checkout"}]});const a=X(),r=W(),n=m(""),s=m(null),u=m(null),p=m(null),h=m(!1),x=m(""),f=m(!1),y=m(""),b=m(""),w=m("FR"),K=[{code:"FR",name:"France"},{code:"DE",name:"Germany"},{code:"IT",name:"Italy"},{code:"ES",name:"Spain"},{code:"GB",name:"United Kingdom"},{code:"US",name:"United States"},{code:"CA",name:"Canada"},{code:"BE",name:"Belgium"},{code:"CH",name:"Switzerland"},{code:"LU",name:"Luxembourg"},{code:"NL",name:"Netherlands"},{code:"PT",name:"Portugal"},{code:"AT",name:"Austria"},{code:"DK",name:"Denmark"},{code:"SE",name:"Sweden"},{code:"NO",name:"Norway"},{code:"FI",name:"Finland"}],g=m({baseAmount:300,taxAmount:0,totalAmount:300,taxPercentage:0}),U=m([{icon:"mdi-database-outline",title:"Database Designer",description:"Create and visually manage your database schemas"},{icon:"mdi-magnify",title:"SEO Audit",description:"Analyze and optimize your SEO performance"},{icon:"mdi-robot",title:"Robots & Schema",description:"Generate robots.txt and schema.org data structures"},{icon:"mdi-palette",title:"Premium Components",description:"Access all components and development tools"}]),A=async()=>{try{h.value=!0;const o=await r.checkout(n.value||"Client",w.value);o.success&&o.taxDetails?(g.value=o.taxDetails,console.log("Tax rates updated for",w.value,":",g.value)):(console.error("Error updating tax rates:",o.error),f.value=!0,y.value="warning",b.value="Unable to update taxes for this country.")}catch(o){console.error("Error updating tax rates:",o)}finally{h.value=!1}};q(async()=>{try{if(A(),u.value=await xe(we.STRIPE_PUBLISHABLE_KEY||""),u.value){p.value=u.value.elements();const o=p.value.create("card",{style:{base:{color:"#e0e0e0",fontFamily:'"Helvetica Neue", Helvetica, sans-serif',fontSmoothing:"antialiased",fontSize:"16px",fontWeight:"400",lineHeight:"1.5","::placeholder":{color:"#9e9e9e"},iconColor:"#bb86fc",":-webkit-autofill":{color:"#e0e0e0"}},invalid:{color:"#cf6679",iconColor:"#cf6679"}}});setTimeout(()=>{s.value&&(o.mount(s.value),o.on("change",t=>{x.value=t.error?t.error.message:""}))},100)}else f.value=!0,y.value="error",b.value="Unable to load Stripe. Please try again."}catch(o){console.error("Error during initial loading:",o),f.value=!0,y.value="error",b.value="Error during initial loading."}});const M=async()=>{if(!u.value||!p.value){f.value=!0,y.value="error",b.value="Unable to connect to Stripe. Please try again.";return}h.value=!0;try{const o=await r.checkout(n.value,w.value);if(!o.success||!o.clientSecret)throw new Error(o.error||"Error creating payment intent");o.taxDetails&&(g.value=o.taxDetails);const{error:t,paymentIntent:c}=await u.value.confirmCardPayment(o.clientSecret,{payment_method:{card:p.value.getElement("card"),billing_details:{name:n.value,address:{country:w.value}}}});if(t)throw new Error(t.message||"Error confirming payment");if(c.status==="succeeded")await r.updatePremiumStatus(!0),f.value=!0,y.value="success",b.value="Payment successful! Premium access activated.",setTimeout(()=>{a.push("/dashboard")},2e3);else throw new Error("Payment was not completed")}catch(o){console.error("Error processing payment:",o),f.value=!0,y.value="error",b.value=o instanceof Error?o.message:"An error occurred while processing payment."}finally{h.value=!1}};return(o,t)=>(V(),E("section",Se,[i(oe,{fluid:"",class:"fill-height pa-0"},{default:l(()=>[i(N,{class:"fill-height ma-0"},{default:l(()=>[i(j,{cols:"12",md:"6",class:"d-none d-md-flex left-panel-checkout align-center justify-center"},{default:l(()=>[e("div",_e,[t[4]||(t[4]=e("h1",null,[e("img",{src:I,alt:"Devunity - Develop faster and better with DevUnity",class:"logo mb-8",width:"350"}),e("span",{class:"sr-only"},"Devunity - Develop faster and better with DevUnity")],-1)),e("div",Ee,[(V(!0),E($,null,Y(U.value,(c,D)=>(V(),E("div",{key:D,class:Q(["feature-item d-flex align-center",{"mb-6":D!==U.value.length-1}])},[i(L,{color:"primary",size:"x-large",class:"mr-3"},{default:l(()=>[P(v(c.icon),1)]),_:2},1024),e("div",Ve,[e("p",Pe,v(c.title),1),e("p",je,v(c.description),1)])],2))),128))])])]),_:1}),i(j,{cols:"12",md:"6",class:"right-panel-checkout d-flex align-center justify-center"},{default:l(()=>[i(Z,{class:"checkout-card pa-8 elevation-0","max-width":"500",width:"100%"},{default:l(()=>[t[11]||(t[11]=e("div",{class:"d-flex justify-center d-md-none mb-8"},[e("img",{src:I,alt:"Devunity Logo",width:"300"})],-1)),t[12]||(t[12]=e("h2",{class:"text-h5 font-weight-bold mb-2"},"Premium Payment",-1)),t[13]||(t[13]=e("p",{class:"text-subtitle-1 text-medium-emphasis mb-8"},"Lifetime access to all premium features",-1)),e("div",Ce,[e("div",ke,[t[5]||(t[5]=e("span",{class:"text-subtitle-1 font-weight-medium"},"Lifetime Premium Access",-1)),e("span",Le,v(g.value.baseAmount)+"€",1)]),i(T,{class:"mb-3"}),e("div",Ue,[t[6]||(t[6]=e("span",{class:"text-body-2 text-medium-emphasis"},"Subtotal",-1)),e("span",Ae,v(g.value.baseAmount)+"€",1)]),e("div",De,[e("span",Te,"VAT ("+v(g.value.taxPercentage)+"%)",1),e("span",Re,v(g.value.taxAmount)+"€",1)]),i(T,{class:"my-3"}),e("div",Ie,[t[7]||(t[7]=e("span",{class:"text-subtitle-1 font-weight-medium"},"Total",-1)),e("span",Ne,v(g.value.totalAmount)+"€",1)])]),i(se,{onSubmit:ee(M,["prevent"])},{default:l(()=>[e("div",Fe,[e("div",Be,[t[8]||(t[8]=e("div",{class:"credit-card-header d-flex justify-space-between align-center mb-4"},[e("div",{class:"credit-card-chip"}),e("div",{class:"d-flex"},[e("img",{src:"https://cdn.jsdelivr.net/gh/aaronfagan/svg-credit-card-payment-icons/flat/visa.svg",class:"credit-card-brand-icon",alt:"Visa"}),e("img",{src:"https://cdn.jsdelivr.net/gh/aaronfagan/svg-credit-card-payment-icons/flat/mastercard.svg",class:"credit-card-brand-icon",alt:"Mastercard"}),e("img",{src:"https://cdn.jsdelivr.net/gh/aaronfagan/svg-credit-card-payment-icons/flat/amex.svg",class:"credit-card-brand-icon",alt:"American Express"})])],-1)),i(N,null,{default:l(()=>[i(j,{cols:"12"},{default:l(()=>[i(ie,{modelValue:n.value,"onUpdate:modelValue":t[0]||(t[0]=c=>n.value=c),label:"Cardholder Name",variant:"outlined","prepend-inner-icon":"mdi-account-outline",class:"mb-4",rules:[c=>!!c||"Name required"],"hide-details":"auto"},null,8,["modelValue","rules"])]),_:1}),i(j,{cols:"12"},{default:l(()=>[i(le,{modelValue:w.value,"onUpdate:modelValue":[t[1]||(t[1]=c=>w.value=c),A],items:K,"item-title":"name","item-value":"code",label:"Billing Country",variant:"outlined","prepend-inner-icon":"mdi-earth",class:"mb-4","hide-details":"auto"},null,8,["modelValue"])]),_:1})]),_:1}),e("div",{ref_key:"cardElement",ref:s,class:"stripe-card-element mb-2"},null,512),x.value?(V(),E("div",ze,v(x.value),1)):te("",!0)])]),i(R,{block:"",color:"primary",type:"submit",loading:h.value,"min-height":"52",class:"text-none font-weight-medium rounded-lg"},{loader:l(()=>[i(ae,{indeterminate:""})]),default:l(()=>[i(L,{start:"",class:"mr-2"},{default:l(()=>t[9]||(t[9]=[P("mdi-credit-card-check-outline")])),_:1}),P(" Pay "+v(g.value.totalAmount)+"€ ",1)]),_:1},8,["loading"]),e("div",Ge,[i(L,{icon:"mdi-shield-check-outline",size:"small",class:"mr-2"}),t[10]||(t[10]=e("span",{class:"text-caption text-medium-emphasis"},"Secure payment via Stripe",-1))])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),i(J,{modelValue:f.value,"onUpdate:modelValue":t[3]||(t[3]=c=>f.value=c),color:y.value,timeout:3e3},{actions:l(()=>[i(R,{icon:"mdi-close",onClick:t[2]||(t[2]=c=>f.value=!1)})]),default:l(()=>[P(v(b.value)+" ",1)]),_:1},8,["modelValue","color"])]))}}),Ze=re(He,[["__scopeId","data-v-fb455e9a"]]);export{Ze as default};
