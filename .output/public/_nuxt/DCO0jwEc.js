import*as h from"monaco-editor";function M(t){if(f(t)){const e={};for(let n=0;n<t.length;n++){const s=t[n],i=p(s)?Y(s):M(s);if(i)for(const o in i)e[o]=i[o]}return e}else if(p(t)||b(t))return t}const W=/;(?![^(]*\))/g,X=/:(.+)/;function Y(t){const e={};return t.split(W).forEach(n=>{if(n){const s=n.split(X);s.length>1&&(e[s[0].trim()]=s[1].trim())}}),e}function E(t){let e="";if(p(t))e=t;else if(f(t))for(let n=0;n<t.length;n++){const s=E(t[n]);s&&(e+=s+" ")}else if(b(t))for(const n in t)t[n]&&(e+=n+" ");return e.trim()}const Z=[],q=()=>{},H=/^on[^a-z]/,J=t=>H.test(t),x=Object.assign,f=Array.isArray,g=t=>typeof t=="function",p=t=>typeof t=="string",K=t=>typeof t=="symbol",b=t=>t!==null&&typeof t=="object";let U;function B(t,e=U){e&&e.active&&e.effects.push(t)}const G=t=>{const e=new Set(t);return e.w=0,e.n=0,e},$=t=>(t.w&d)>0,A=t=>(t.n&d)>0,Q=({deps:t})=>{if(t.length)for(let e=0;e<t.length;e++)t[e].w|=d},tt=t=>{const{deps:e}=t;if(e.length){let n=0;for(let s=0;s<e.length;s++){const i=e[s];$(i)&&!A(i)?i.delete(t):e[n++]=i,i.w&=~d,i.n&=~d}e.length=n}};let _=0,d=1;const C=30;let c;class et{constructor(e,n=null,s){this.fn=e,this.scheduler=n,this.active=!0,this.deps=[],this.parent=void 0,B(this,s)}run(){if(!this.active)return this.fn();let e=c,n=v;for(;e;){if(e===this)return;e=e.parent}try{return this.parent=c,c=this,v=!0,d=1<<++_,_<=C?Q(this):O(this),this.fn()}finally{_<=C&&tt(this),d=1<<--_,c=this.parent,v=n,this.parent=void 0,this.deferStop&&this.stop()}}stop(){c===this?this.deferStop=!0:this.active&&(O(this),this.onStop&&this.onStop(),this.active=!1)}}function O(t){const{deps:e}=t;if(e.length){for(let n=0;n<e.length;n++)e[n].delete(t);e.length=0}}let v=!0;function nt(t,e){let n=!1;_<=C?A(t)||(t.n|=d,n=!$(t)):n=!t.has(c),n&&(t.add(c),c.deps.push(t))}function st(t,e){const n=f(t)?t:[...t];for(const s of n)s.computed&&V(s);for(const s of n)s.computed||V(s)}function V(t,e){(t!==c||t.allowRecurse)&&(t.scheduler?t.scheduler():t.run())}new Set(Object.getOwnPropertyNames(Symbol).filter(t=>t!=="arguments"&&t!=="caller").map(t=>Symbol[t]).filter(K));function I(t){return R(t)?I(t.__v_raw):!!(t&&t.__v_isReactive)}function R(t){return!!(t&&t.__v_isReadonly)}function D(t){return I(t)||R(t)}function w(t){const e=t&&t.__v_raw;return e?w(e):t}function it(t){v&&c&&(t=w(t),nt(t.dep||(t.dep=G())))}function ot(t,e){t=w(t),t.dep&&st(t.dep)}function N(t){return!!(t&&t.__v_isRef===!0)}function rt(t){const e=f(t)?new Array(t.length):{};for(const n in t)e[n]=ut(t,n);return e}class lt{constructor(e,n,s){this._object=e,this._key=n,this._defaultValue=s,this.__v_isRef=!0}get value(){const e=this._object[this._key];return e===void 0?this._defaultValue:e}set value(e){this._object[this._key]=e}}function ut(t,e,n){const s=t[e];return N(s)?s:new lt(t,e,n)}class at{constructor(e,n,s,i){this._setter=n,this.dep=void 0,this.__v_isRef=!0,this._dirty=!0,this.effect=new et(e,()=>{this._dirty||(this._dirty=!0,ot(this))}),this.effect.computed=this,this.effect.active=this._cacheable=!i,this.__v_isReadonly=s}get value(){const e=w(this);return it(e),(e._dirty||!e._cacheable)&&(e._dirty=!1,e._value=e.effect.run()),e._value}set value(e){this._setter(e)}}function ct(t,e,n=!1){let s,i;const o=g(t);return o?(s=t,i=q):(s=t.get,i=t.set),new at(s,i,o||!i,n)}let y=null,ht=null;const dt=t=>t.__isSuspense;function ft(t){return g(t)?{setup:t,name:t.name}:t}const pt=Symbol(),gt=t=>t.__isTeleport,z=Symbol(void 0),_t=Symbol(void 0),vt=Symbol(void 0),m=[];let a=null;function yt(t=!1){m.push(a=t?null:[])}function mt(){m.pop(),a=m[m.length-1]||null}function St(t){return t.dynamicChildren=a||Z,mt(),a&&a.push(t),t}function bt(t,e,n,s,i,o){return St(T(t,e,n,s,i,o,!0))}function Mt(t){return t?t.__v_isVNode===!0:!1}const L="__vInternal",P=({key:t})=>t??null,S=({ref:t,ref_key:e,ref_for:n})=>t!=null?p(t)||N(t)||g(t)?{i:y,r:t,k:e,f:!!n}:t:null;function T(t,e=null,n=null,s=0,i=null,o=t===z?0:1,r=!1,l=!1){const u={__v_isVNode:!0,__v_skip:!0,type:t,props:e,key:e&&P(e),ref:e&&S(e),scopeId:ht,slotScopeIds:null,children:n,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetAnchor:null,staticCount:0,shapeFlag:o,patchFlag:s,dynamicProps:i,dynamicChildren:null,appContext:null};return l?(j(u,n),o&128&&t.normalize(u)):n&&(u.shapeFlag|=p(n)?8:16),!r&&a&&(u.patchFlag>0||o&6)&&u.patchFlag!==32&&a.push(u),u}const wt=Ft;function Ft(t,e=null,n=null,s=0,i=null,o=!1){if((!t||t===pt)&&(t=vt),Mt(t)){const l=k(t,e,!0);return n&&j(l,n),!o&&a&&(l.shapeFlag&6?a[a.indexOf(t)]=l:a.push(l)),l.patchFlag|=-2,l}if(Ot(t)&&(t=t.__vccOpts),e){e=Ct(e);let{class:l,style:u}=e;l&&!p(l)&&(e.class=E(l)),b(u)&&(D(u)&&!f(u)&&(u=x({},u)),e.style=M(u))}const r=p(t)?1:dt(t)?128:gt(t)?64:b(t)?4:g(t)?2:0;return T(t,e,n,s,i,r,o,!0)}function Ct(t){return t?D(t)||L in t?x({},t):t:null}function k(t,e,n=!1){const{props:s,ref:i,patchFlag:o,children:r}=t,l=e?Et(s||{},e):s;return{__v_isVNode:!0,__v_skip:!0,type:t.type,props:l,key:l&&P(l),ref:e&&e.ref?n&&i?f(i)?i.concat(S(e)):[i,S(e)]:S(e):i,scopeId:t.scopeId,slotScopeIds:t.slotScopeIds,children:r,target:t.target,targetAnchor:t.targetAnchor,staticCount:t.staticCount,shapeFlag:t.shapeFlag,patchFlag:e&&t.type!==z?o===-1?16:o|16:o,dynamicProps:t.dynamicProps,dynamicChildren:t.dynamicChildren,appContext:t.appContext,dirs:t.dirs,transition:t.transition,component:t.component,suspense:t.suspense,ssContent:t.ssContent&&k(t.ssContent),ssFallback:t.ssFallback&&k(t.ssFallback),el:t.el,anchor:t.anchor}}function kt(t=" ",e=0){return wt(_t,null,t,e)}function j(t,e){let n=0;const{shapeFlag:s}=t;if(e==null)e=null;else if(f(e))n=16;else if(typeof e=="object")if(s&65){const i=e.default;i&&(i._c&&(i._d=!1),j(t,i()),i._c&&(i._d=!0));return}else{n=32;const i=e._;!i&&!(L in e)&&(e._ctx=y)}else g(e)?(e={default:e,_ctx:y},n=32):(e=String(e),s&64?(n=16,e=[kt(e)]):n=8);t.children=e,t.shapeFlag|=n}function Et(...t){const e={};for(let n=0;n<t.length;n++){const s=t[n];for(const i in s)if(i==="class")e.class!==s.class&&(e.class=E([e.class,s.class]));else if(i==="style")e.style=M([e.style,s.style]);else if(J(i)){const o=e[i],r=s[i];r&&o!==r&&!(f(o)&&o.includes(r))&&(e[i]=o?[].concat(o,r):r)}else i!==""&&(e[i]=s[i])}return e}let jt=!1;function Ot(t){return g(t)&&"__vccOpts"in t}const Vt=(t,e)=>ct(t,e,jt),xt=(t,e)=>{const n=t.__vccOpts||t;for(const[s,i]of e)n[s]=i;return n},$t=ft({name:"MonacoEditor",props:{diffEditor:{type:Boolean,default:!1},width:{type:[String,Number],default:"100%"},height:{type:[String,Number],default:"100%"},original:String,value:String,language:{type:String,default:"javascript"},theme:{type:String,default:"vs"},options:{type:Object,default(){return{}}}},emits:["editorWillMount","editorDidMount","change","update:value"],setup(t){const{width:e,height:n}=rt(t);return{style:Vt(()=>{const s=e.value.toString().includes("%")?e.value:`${e.value}px`,i=n.value.toString().includes("%")?n.value:`${n.value}px`;return{width:s,height:i,"text-align":"left"}})}},mounted(){this.initMonaco()},beforeUnmount(){this.editor&&this.editor.dispose()},methods:{initMonaco(){this.$emit("editorWillMount",h);const{value:t,language:e,theme:n,options:s}=this;this.editor=h.editor[this.diffEditor?"createDiffEditor":"create"](this.$el,{value:t,language:e,theme:n,...s}),this.diffEditor&&this._setModel(this.value,this.original);const i=this._getEditor();i&&i.onDidChangeModelContent(o=>{const r=i.getValue();this.value!==r&&(this.$emit("change",r,o),this.$emit("update:value",r))}),this.$emit("editorDidMount",this.editor)},_setModel(t,e){const{language:n}=this,s=h.editor.createModel(e,n),i=h.editor.createModel(t,n);this.editor.setModel({original:s,modified:i})},_setValue(t){let e=this._getEditor();if(e)return e.setValue(t)},_getValue(){let t=this._getEditor();return t?t.getValue():""},_getEditor(){return this.editor?this.diffEditor?this.editor.modifiedEditor:this.editor:null},_setOriginal(){const{original:t}=this.editor.getModel();t.setValue(this.original)}},watch:{options:{deep:!0,handler(t){this.editor.updateOptions(t)}},value(){this.value!==this._getValue()&&this._setValue(this.value)},original(){this._setOriginal()},language(){if(this.editor)if(this.diffEditor){const{original:t,modified:e}=this.editor.getModel();h.editor.setModelLanguage(t,this.language),h.editor.setModelLanguage(e,this.language)}else h.editor.setModelLanguage(this.editor.getModel(),this.language)},theme(){h.editor.setTheme(this.theme)}}});function At(t,e,n,s,i,o){return yt(),bt("div",{class:"monaco-editor-vue3",style:M(t.style)},null,4)}const F=xt($t,[["render",At]]);F.install=t=>{t.component(F.name,F)};export{F as default};
